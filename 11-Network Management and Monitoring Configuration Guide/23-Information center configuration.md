
# Configuring the information center

## About the information center

The information
center on the device receives logs generated by source modules and outputs logs
to different destinations according to log output rules. Based on the logs, you
can monitor device performance and troubleshoot network problems.

Figure 1 Information center diagram

![](https://resource.h3c.com/en/202407/12/20240712_11705829_x_Img_x_png_0_2216128_294551_0.png)

‌

### Log types

Logs are classified into the following
types:

·     Standard system logs—Record common system information. Unless otherwise specified, the
term "logs" in this document refers to standard system logs.

·     Diagnostic logs—Record debugging messages.

·     Security logs—Record security information, such as authentication and authorization
information.

·     Hidden logs—Record log information not displayed on the terminal, such as input
commands.

·     Trace logs—Record system tracing and debugging messages, which can be viewed
only after the devkit package is installed.

### Log levels

Logs are classified into eight severity levels
from 0 through 7 in descending order. The information center outputs logs with a
severity level that is higher than or equal to the specified level. For
example, if you specify a severity level of 6 (informational), logs that have a
severity level from 0 to 6 are output.

Table 1 Log levels

| Severity value | Level | Description |
| --- | --- | --- |
| 0 | Emergency | The system is unusable. For example, the system authorization has expired. || 1 | Alert | Action must be taken immediately. For example, traffic on an interface exceeds the upper limit. || 2 | Critical | Critical condition. For example, the device temperature exceeds the upper limit, the power module fails, or the fan tray fails. || 3 | Error | Error condition. For example, the link state changes. || 4 | Warning | Warning condition. For example, an interface is disconnected, or the memory resources are used up. || 5 | Notification | Normal but significant condition. For example, a terminal logs in to the device, or the device reboots. || 6 | Informational | Informational message. For example, a command or a ping operation is executed. || 7 | Debugging | Debugging message. |








‌

### Log destinations

The system outputs logs to the following
destinations: console, monitor terminal, log buffer, log host, and log file. Log
output destinations are independent and you can configure them after enabling
the information center. One log can be sent to multiple destinations.

### Defaultoutput rules for logs

A log output rule specifies the source
modules and severity level of logs that can be output to a destination. Logs
matching the output rule are output to the destination. [Table 2](#_Ref179686485) shows
the default log output rules.

Table 2 Default output rules

| Destination | Log source modules | Output switch | Severity |
| --- | --- | --- | --- |
| Console | All supported modules | Enabled | Debugging || Monitor terminal | All supported modules | Disabled | Debugging || Log host | All supported modules | Enabled | Informational || Log buffer | All supported modules | Enabled | Informational || Log file | All supported modules | Enabled | Informational |





‌

### Default output rules for diagnostic logs

Diagnostic logs can only be output to the
diagnostic log file, and cannot be filtered by source modules and severity
levels. [Table 3](#_Ref372115751) shows
the default output rule for diagnostic logs.

Table 3 Default output rule for diagnostic
logs

| Destination | Log source modules | Output switch | Severity |
| --- | --- | --- | --- |
| Diagnostic log file | All supported modules | Enabled | Debugging |

‌

### Default output rules for security logs

Security logs can only be output to the
security log file, and cannot be filtered by source modules and severity
levels. [Table 4](#_Ref372115770) shows
the default output rule for security logs.

Table 4 Default output rule for security
logs

| Destination | Log source modules | Output switch | Severity |
| --- | --- | --- | --- |
| Security log file | All supported modules | Disabled | Debugging |

‌

### Default output rules for hidden logs

Hidden logs can be output to the log host, the
log buffer, and the log file. [Table 5](#_Ref372115788) shows
the default output rules for hidden logs.

Table 5 Default output rules for hidden logs

| Destination | Log source modules | Output switch | Severity |
| --- | --- | --- | --- |
| Log host | All supported modules | Enabled | Informational || Log buffer | All supported modules | Enabled | Informational || Log file | All supported modules | Enabled | Informational |



‌

### Default output rules for trace logs

Trace logs can only be output to the trace
log file, and cannot be filtered by source modules and severity levels. [Table 6](#_Ref372115800) shows
the default output rules for trace logs.

Table 6 Default output rules for trace logs

| Destination | Log source modules | Output switch | Severity |
| --- | --- | --- | --- |
| Trace log file | All supported modules | Enabled | Debugging |

‌

### Log formats and field descriptions

#### Log formats

The format of logs varies by output
destinations. [Table 7](#_Ref482461859) shows
the original format of log information, which might be different from what you
see. The actual format varies by the log resolution tool used.

Table 7 Log formats

| Output destination | Format || Console, monitor terminal, log buffer, or log file | Prefix Timestamp Sysname Module/Level/Mnemonic: Content  Example:  %Nov 24 14:21:43:502 2019 Sysname SHELL/5/SHELL\_LOGIN: VTY logged in from 192.168.1.26 || Log host | Non-customized format:  \<PRI\>Timestamp Sysname %%vvModule/Level/Mnemonic: Location; Content  Example:  \<190\>Nov 24 16:22:21 2019 Sysname %%10SHELL/5/SHELL\_LOGIN: -DevIP\=1.1.1.1; VTY logged in from 192.168.1.26\<190\>Nov 24 16:22:21 2016 Sysname %%10 SHELL/5/SHELL\_LOGIN: -DevIP\=1.1.1.1; VTY logged in from 192.168.1.26  CMCC format:  \<PRI\>Timestamp Sysname %vvModule/Level/Mnemonic: Location; Content  \<189\>Oct 9 14:59:04 2019 Sysname %10SHELL/5/SHELL\_LOGIN: VTY logged in from 192.168.1.21  RFC 5424 format:  \<PRI\>Version Timestamp Sysname Module \- Mnemonic \[SysLoc]\[AppLoc] Content  \<190\>1 2020-09-25T10:42:22.257Z Sysname SHELL – SHELL\_LOGIN \[SysLoc@25506 VendorID\=%%10 Level\=6]\[AppLoc@25506 Line\=vty0 IPAddr\=192.168.1.21 User\=\*\*] VTY logged in from 192.168.1.21  SGCC format:  \<PRI\> Timestamp Sysname Devtype Content  \<189\> 2019-03-18 15:39:45 Sysname FW 0 2 admin 10.1.1.1  Unicom format:  \<PRI\>Timestamp Hostip vvModule/Level/Serial\_number: Content  Example:  \<189\>Oct 13 16:48:08 2019 10.1.1.1 10SHELL/5/210231a64jx073000020: VTY logged in from 192.168.1.21 |


| --- | --- | --- | --- | --- | --- |

‌

#### Log field description

Table 8 Log field description

| Field | Description |
| --- | --- |
| Prefix (information type) | A log to a destination other than the log host has an identifier in front of the timestamp:  ·     An identifier of percent sign (%) indicates a log with a level equal to or higher than informational.  ·     An identifier of asterisk (\*) indicates a debugging log or a trace log.  ·     An identifier of caret (^) indicates a diagnostic log. || PRI (priority) | A log destined for the log host has a priority identifier in front of the timestamp. The priority is calculated by using this formula: facility\*8\+level, where:  ·     facility is the facility name. Facility names local0 through local7 correspond to values 16 through 23\. The facility name can be configured using the info-center loghost command. It is used to identify log sources on the log host, and to query and filter the logs from specific log sources.  ·     level is in the range of 0 to 7\. See [Table 1](#_Ref155340060) for more information about severity levels. || Timestamp | Records the time when the log was generated.  Logs sent to the log host and those sent to the other destinations have different timestamp precisions, and their timestamp formats are configured with different commands. For more information, see [Table 9](#_Ref482461952) and [Table 10](#_Ref482462011). || Hostip | Source IP address of the log. If the info-center loghost source command is configured, this field displays the IP address of the specified source interface. Otherwise, this field displays the sysname.  This field exists only in logs that are sent to the log host in unicom format. || Serial number | Serial number of the device that generated the log.  This field exists only in logs that are sent to the log host in unicom format. || Sysname (host name or host IP address) | The sysname is the host name or IP address of the device that generated the log. You can use the sysname command to modify the name of the device. || %% (vendor ID) | Indicates that the information was generated by an H3C device.  This field exists only in logs sent to the log host. || vv (version information) | Identifies the version of the log, and has a value of 10\.  This field exists only in logs that are sent to the log host. || Module | Specifies the name of the module that generated the log. You can enter the info-center source ? command in system view to view the module list. || Level | Identifies the level of the log. See [Table 1](#_Ref155340060) for more information about severity levels. || Mnemonic | Describes the content of the log. It contains a string of up to 32 characters. || Location | Optional field that identifies the log sender. This field exists only in logs that are sent to the log host in non-customized or CMCC format.  The field contains the following information:  ·     Devlp—IP address of the log sender.  ·     Slot—Member ID of the IRF member device that sent the log. || SysLoc | Optional field that identifies the system information of the logs. This field exists only in logs that are sent to the log host in RFC 5424 format.  The field contains the following information:  ·     SysLoc@—Vendor number of the device that generates logs.  ·     VendorID—Vendor ID. Currently, the fixed value is 10\.  ·     Level—Log level.  ·     Slot—Member ID of the IRF member device that sent the log. || AppLoc | Optional field that identifies the module information of the logs. This field exists only in logs that are sent to the log host in RFC 5424 format.  The field contains the following information:  ·     AppLoc@—Vendor number of the device that generates logs.  ·     Line—User line used by the current user for login.  ·     IPAddr—IP address used for user login.  ·     User—Username for login. || Content | Provides the content of the log. |















‌

Table 9 Timestamp precisions and
configuration commands

| Item | Destined for the log host | Destined for the console, monitor terminal, log buffer, and log file |
| --- | --- | --- |
| Precision | Seconds (default) or milliseconds | Milliseconds || Command used to set the timestamp format | info-center timestamp loghost | info-center timestamp |


‌

Table 10 Description of the timestamp
parameters

| Timestamp parameters | Description |
| --- | --- |
| boot | Time that has elapsed since system startup, in the format of xxx.yyy. xxx represents the higher 32 bits, and yyy represents the lower 32 bits, of milliseconds elapsed.  Logs that are sent to all destinations other than a log host support this parameter.  Example:  %0.109391473 Sysname FTPD/5/FTPD\_LOGIN: User ftp (192.168.1.23) has logged in successfully.  0.109391473 is a timestamp in the boot format. || date | Current date and time.  ·     For logs output to a log host, the timestamp can be in the format of MMM DD hh:mm:ss YYYY (accurate to seconds) or MMM DD hh:mm:ss.ms YYYY (accurate to milliseconds).  ·     For logs output to other destinations, the timestamp is in the format of MMM DD hh:mm:ss:ms YYYY.  All logs support this parameter.  Example:  %May 30 05:36:29:579 2019 Sysname FTPD/5/FTPD\_LOGIN: User ftp (192.168.1.23) has logged in successfully.  May 30 05:36:29:579 2019 is a timestamp in the date format in logs sent to the console. || iso | Timestamp format stipulated in ISO 8601, accurate to seconds (default) or milliseconds.  Only logs that are sent to a log host support this parameter.  Example:  \<189\>2019-05-30T06:42:44 Sysname %%10FTPD/5/FTPD\_LOGIN: User ftp (192.168.1.23) has logged in successfully.  2019-05-30T06:42:44 is a timestamp in the iso format accurate to seconds. A timestamp accurate to milliseconds is like 2019-05-30T06:42:44.708. || none | No timestamp is included.  All logs support this parameter.  Example:  % Sysname FTPD/5/FTPD\_LOGIN: User ftp (192.168.1.23) has logged in successfully.  No timestamp is included. || no-year-date | Current date and time without year or millisecond information, in the format of MMM DD hh:mm:ss.  Only logs that are sent to a log host support this parameter.  Example:  \<189\>May 30 06:44:22 Sysname %%10FTPD/5/FTPD\_LOGIN: User ftp (192.168.1.23) has logged in successfully.  May 30 06:44:22 is a timestamp in the no-year-date format. |





‌

## FIPS compliance

The device supports the FIPS mode that
complies with NIST FIPS 140-2 requirements. Support for features, commands, and
parameters might differ in FIPS mode and non-FIPS mode. For more information
about FIPS mode, see Security Configuration Guide.

## Information center tasks at a glance

### Managing standard system logs

**1\.**[Enabling the information center](#_Ref458776870)

**2\.**[Outputting logs to various destinations](#_Ref473121976)

Choose the following tasks as needed:

¡     [Outputting logs to the console](#_Ref472857691)

¡     [Outputting logs to the monitor terminal](#_Ref472857703)

¡     [Outputting logs to log hosts](#_Ref165188668)

¡     [Outputting logs to the log buffer](#_Ref114211490)

¡     [Saving logs to the log file](#_Ref114211498)

**3\.**(Optional.) [Setting the minimum storage period](#_Ref114211508)

**4\.**(Optional.) [Enabling synchronous information output](#_Ref472857765)

**5\.**(Optional.) [Configuring log suppression](#_Ref473122189)

Choose the following tasks as needed:

¡     [Enabling duplicate log suppression](#_Ref472857786)

¡     [Configuring log suppression for a module](#_Ref472857804)

¡     [Disabling an interface from generating link
up or link down logs](#_Ref472857808)

**6\.**(Optional.) [Enabling SNMP notifications for system logs](#_Ref472857837)

### Managing hidden logs

**1\.**[Enabling the information center](#_Ref458776870)

**2\.**[Outputting logs to various destinations](#_Ref473121976)

Choose the following tasks as needed:

¡     [Outputting logs to log hosts](#_Ref165188668)

¡     [Outputting logs to the log buffer](#_Ref114211490)

¡     [Saving logs to the log file](#_Ref114211498)

**3\.**(Optional.) [Setting the minimum storage period](#_Ref114211508)

**4\.**(Optional.) [Configuring log suppression](#_Ref473122189)

Choose the following tasks as needed: 

¡     [Enabling duplicate log suppression](#_Ref472857786)

¡     [Configuring log suppression for a module](#_Ref472857804)

### Managing security logs

**1\.**[Enabling the information center](#_Ref458776870)

**2\.**(Optional.) [Configuring log suppression](#_Ref473122189)

Choose the following tasks as needed:

¡     [Enabling duplicate log suppression](#_Ref472857786)

¡     [Configuring log suppression for a module](#_Ref472857804)

**3\.**[Managing security logs](#_Ref472858371)

¡     [Saving security logs to the security log
file](#_Ref472858378)

¡     [Managing the security log file](#_Ref472858384)

### Managing diagnostic logs

**1\.**[Enabling the information center](#_Ref458776870)

**2\.**(Optional.) [Configuring log suppression](#_Ref473122189)

Choose the following tasks as needed:

¡     [Enabling duplicate log suppression](#_Ref472857786)

¡     [Configuring log suppression for a module](#_Ref472857804)

**3\.**[Saving diagnostic logs to the diagnostic
log file](#_Ref351744210)

### Managing trace logs

**1\.**[Enabling the information center](#_Ref458776870)

**2\.**(Optional.) [Configuring log suppression](#_Ref473122189)

Choose the following tasks as needed:

¡     [Enabling duplicate log suppression](#_Ref472857786)

¡     [Configuring log suppression for a module](#_Ref472857804)

**3\.**[Setting the maximum size of the trace log
file](#_Ref472858469)

## Enabling the information center

#### About this task

The information center can output logs only
after it is enabled.

#### Procedure

**1\.**Enter system view.

system-view

**2\.**Enable the information center.

info-center enable

The information center is enabled by
default.

## Outputting logs to various destinations

### Outputting logs to the console

#### Restrictions and guidelines

The terminal monitor, terminal debugging,
and
terminal logging commands take effect only for
the current connection between the terminal and the device. If a new connection
is established, the default is restored.

#### Procedure

**1\.**Enter system view.

system-view

**2\.**(Optional.) Configure an output rule for
sending logs to the console.

info-center source { module-name \| default } console { deny \| level severity }

For information about the default output
rules, see "[Default output rules for logs](#_Ref353265091)."

**3\.**(Optional.) Configure the timestamp format.

info-center timestamp { boot \| date \| none }

The default timestamp format is date.

**4\.**Return to user view.

quit

**5\.**Enable log output to the console.

terminal monitor

By default, log output to the console is enabled.

**6\.**Enable output of debugging messages to the console.

terminal debugging

By default, output of debugging messages to
the console is disabled.

This command enables output of debugging-level
log messages to the console.

**7\.**Set the lowest severity level of logs that
can be output to the console.

terminal logging level severity

The default setting is 6 (informational).

### Outputting logs to the monitor terminal

#### About this task

Monitor terminals refer to terminals that
log in to the device through the AUX or VTY line. 

#### Restrictions and guidelines

The terminal monitor, terminal debugging,
and
terminal logging commands take effect only for
the current connection between the terminal and the device. If a new connection
is established, the default is restored.

#### Procedure

**1\.**Enter system view.

system-view

**2\.**(Optional.) Configure an output rule for
sending logs to the monitor terminal.

info-center source { module-name \| default } monitor { deny \| level severity }

For information about the default output
rules, see "[Default output rules for logs](#_Ref353265091)."

**3\.**(Optional.) Configure the timestamp format.

info-center timestamp { boot \| date \| none }

The default timestamp format is date.

**4\.**Return to user view.

quit

**5\.**Enable log output to the monitor terminal.

terminal monitor

By default, log output to the monitor
terminal is disabled.

**6\.**Enable output of debugging messages to the monitor
terminal.

terminal debugging

By default, output of debugging messages to
the monitor terminal is disabled.

This command enables output of debugging-level
log messages to the monitor terminal.

**7\.**Set the lowest level of logs that can be
output to the monitor terminal.

terminal logging level severity

The default setting is 6 (informational).

### Outputting logs to log hosts

#### Restrictions and guidelines

The device supports using the information
center to output logs of a module to designated log hosts. 

#### Procedure

**1\.**Enter system view.

system-view

**2\.**(Optional.) Configure a log output filter or
a log output rule. Choose one option as needed:

¡     Configure
a log output filter.

info-center filter filter-name { module-name \| default } { deny \| level severity }

You can create multiple log output
filters. When specifying a log host, you can apply a log output filter to the
log host to control log output.

¡     Configure
a log output rule for the log host output destination.

info-center source { module-name \| default } loghost { deny \| level severity }

For information about the default log
output rules for the log host output destination, see "[Default output rules for logs](#_Ref353265091)."

The system chooses the settings to
control log output to a log host in the following order:

**a.**Log output filter applied to the log host.

**b.**Log output rules configured for the log host
output destination by using the info-center source command.

**c.**Default log output rules (see "[Default output rules for logs](#_Ref353265091)").

**3\.**(Optional.) Specify a source IP address for
logs sent to log hosts.

info-center loghost source interface-type interface-number

By default, the source IP address of logs
sent to log hosts is the primary IP address of their outgoing interfaces.

**4\.**(Optional.) Specify the format in which logs
are output to log hosts.

info-center format { cmcc \| rfc5424 \| unicom }

By default, logs are output to log hosts
in non-customized format.

**5\.**(Optional.) Add the device serial number to
the location field of logs sent to log hosts.

info-center loghost
locate-info with-sn

By default, the device does not add the
device serial number to the location field of logs sent to log hosts.

**6\.**(Optional.) Configure the timestamp format.

info-center timestamp loghost { date \[ with-milliseconds ] \| iso \[ with-milliseconds \| with-timezone ] \* \| no-year-date \| none }

The default timestamp format is date.

**7\.**Specify a log host and configure related
parameters.

info-center loghost \[ vpn-instance
vpn-instance-name ] { hostname \| ipv4-address \| ipv6 ipv6-address } \[ port port-number ] \[ dscp dscp-value ] \[ facility local-number ] \[ filter filter-name ]

By default, no log hosts or related
parameters are specified.

The value for the port-number argument must be the same as the value configured on the log host.
Otherwise, the log host cannot receive logs.

### Outputting logs to the log buffer

#### About this task

This feature enables log output to the log
buffer. You can use the display logbuffer
command to display the log buffer information and the buffered logs.

#### Procedure

**1\.**Enter system view.

system-view

**2\.**(Optional.) Configure an output rule for
sending logs to the log buffer.

info-center source { module-name \| default } logbuffer { deny \| level severity }

For information about the default output
rules, see "[Default output rules for logs](#_Ref353265091)."

**3\.**(Optional.) Configure the timestamp format.

info-center timestamp { boot \| date \| none }

The default timestamp format is date.

**4\.**Enable log output to the log buffer.

info-center logbuffer

By default, log output to the log buffer
is enabled.

**5\.**(Optional.) Set the maximum log buffer size.

info-center logbuffer size buffersize

By default, a maximum of 512 logs can be
buffered.

### Saving logs to the log file

#### About this task

The log file feature enables log output to
the log file. The system saves logs from the log file buffer to the log file. After
saving logs to the log file, the system clears the log file buffer.

Log saving from the log file buffer to the
log file is triggered by the following situations:

·     Periodic saving.

·     A manual immediate saving of buffered logs to
the log file.

·     The log file buffer is full.

A log file is automatically created when
needed and has a maximum capacity. The log file capacity restrictions are as
follows:

·     When no log file space is available, the device
stops saving new logs.

When no log file space or storage device
space is available, the system will replace the oldest logs with new logs.

 

| TIP | TIP:  ·     Clean up the storage space of the device regularly to ensure sufficient storage space for the log file feature.  ·     As a best practice, back up the log files regularly to avoid loss of important logs. |
| --- | --- |

‌

#### Procedure

**1\.**Enter system view.

system-view

**2\.**(Optional.) Configure an output rule for
sending logs to the log file.

info-center source { module-name \| default } logfile { deny \| level severity }

For information about the default output
rules, see "[Default output rules for logs](#_Ref353265091)."

**3\.**Enable the log file feature.

info-center logfile enable

By default, the log file feature is
enabled.

**4\.**(Optional.) Set the maximum log file size.

info-center logfile size-quota size

By default, the maximum log file size is 10
MB.

**5\.**(Optional.) Specify the log file directory.

info-center logfile directory dir-name

The default log file directory is flash:/logfile.

This command cannot survive an IRF reboot
or a master/subordinate switchover.

**6\.**Save logs in the log file buffer to the log
file. Choose one or both options as needed:

¡     Configure the automatic log file saving interval.

info-center logfile frequency freq-sec

The default log file saving interval is
86400 seconds.

¡     Immediately
save logs from the log file buffer to the log file.

logfile save

This command is available in any view.

## Setting the minimum storage period

#### About this task

Use this feature to set the minimum storage
period for logs in the log buffer and log file. This feature ensures that logs
will not be overwritten by new logs during a set period of time.

By default, when the log buffer or log file
is full, new logs will automatically overwrite the oldest logs. After the
minimum storage period is set, the system identifies the storage period of a
log to determine whether to delete the log. The system current time minus a log's
generation time is the log's storage period.

·     If the storage period of a log is shorter than
or equal to the minimum storage period, the system does not delete the log. The
new log will not be saved.

·     If the storage period of a log is longer than
the minimum storage period, the system deletes the log to save the new log.

#### Procedure

**1\.**Enter system view.

system-view

**2\.**Set the log minimum storage period for logs.

info-center syslog min-age min-age

By default, the log minimum storage
period is not set.

## Enabling synchronous information output

#### About this task

System log output interrupts ongoing
configuration operations, obscuring previously entered commands. Synchronous
information output shows the obscured commands. It also provides a command
prompt in command editing mode, or a \[Y/N] string in interaction mode so you can continue your operation from
where you were stopped.

#### Procedure

**1\.**Enter system view.

system-view

**2\.**Enable synchronous information output.

info-center synchronous

By default, synchronous information
output is disabled.

## Configuring log suppression

### Enabling duplicate log suppression

#### About this task

The information center on the device outputs
logs generated by service modules. The device identifies logs that have the
same module name, level, mnemonic, location, and text as duplicate logs.

In some scenarios, for example, ARP attack
or link failure, the service modules will generate a large volume of duplicate logs
during a short period of time. Recording and output of consecutive duplicate
logs wastes system and network resources. To resolve this issue, you can enable
duplicate log suppression.

With this feature enabled, when a service
module generates a log, the information center outputs the log and starts the duplicate
log suppression timer. The suppression period of the duplicate log suppression
timer varies by phase. The suppression periods in phase 1, 2, and later phases
are 30 seconds, 2 minutes, and 10 minutes, respectively.

After you enable duplicate log suppression,
the system starts suppression upon outputting a log:

·     If only duplicate logs of the log are received
during the suppression period of a phase, the information center does not
output the duplicate logs. When the suppression period of the phase expires,
the information center outputs the suppressed log and the number of times the
log is suppressed, and starts the next suppression phase.

·     If a different log is received during the
suppression period of a phase, the information center performs the following
operations:

¡     Stops
suppression on the log, and outputs the suppressed log and the number of times
the log is suppressed.

¡     Outputs
the different log and starts phase-1 suppression for that log.

·     If no log is received within the suppression
period of any phase, the information center deletes the duplicate log
suppression timer, stops suppression on the log, and does not output any log.

#### Procedure

**1\.**Enter system view.

system-view

**2\.**Enable duplicate log suppression.

info-center logging suppress duplicates

By default, duplicate log suppression is
disabled.

#### Examples

The following example uses SHELL\_CMD logs
to verify the duplicate log suppression feature. After the user executes a
command on the device, the information center receives a SHELL\_CMD log
generated by the shell module, encapsulates the log, and then outputs the log
to the log buffer.

**1\.**Verify the suppression effect in phases 1,
2, 3, and 4 of a log (with suppression period of 30 seconds, 2 minutes, 10
minutes, and 10 minutes):

\# In a lab environment, continuously
execute the display logbuffer
command for 25 minutes.

\# View the output logs in the log buffer.

\<Sysname\> display
logbuffer

Log buffer: Enabled

Max buffer size: 1024

Actual buffer size: 512

Dropped messages: 0

Overwritten messages: 0

Current messages: 5

%Jul 20 13:01:20:615 2022 Sysname
SHELL/6/SHELL\_CMD: -Line\=con0-IPAddr\=\*\*-User\=\*\*; Command is display logbuffer

%Jul 20 13:01:50:718 2022 Sysname
SHELL/6/SHELL\_CMD: -Line\=con0-IPAddr\=\*\*-User\=\*\*; Command is display logbuffer This message repeated 2 times in last 30 seconds.

%Jul 20 13:03:50:732 2022 Sysname
SHELL/6/SHELL\_CMD: -Line\=con0-IPAddr\=\*\*-User\=\*\*; Command is display logbuffer This message repeated 5 times in last 2 minutes.

%Jul 20 13:13:50:830 2022 Sysname
SHELL/6/SHELL\_CMD: -Line\=con0-IPAddr\=\*\*-User\=\*\*; Command is display logbuffer This message repeated 10 times in last 10 minutes.

%Jul 20 13:23:50:211 2022 Sysname
SHELL/6/SHELL\_CMD: -Line\=con0-IPAddr\=\*\*-User\=\*\*; Command is display logbuffer This message repeated 6 times in last 10 minutes.

The output shows the following
information:

¡     The information
center received the log SHELL/6/SHELL\_CMD:
-Line\=con0-IPAddr\=\*\*-User\=\*\*; Command is display logbuffer.

¡     In
phase 1, the log was suppressed twice by the information center.

¡     In
phase 2, the log was suppressed five times by the information center.

¡     In
phase 3, the log was suppressed 10 times by the information center.

¡     In
phase 4, the log was suppressed six times by the information center.

**2\.**Continue to verify how duplicate log
suppression works when a different log is received during the suppression
period of a log:

\# Execute the display
logbuffer command three times, and then execute
the display
interface brief command. 

\# View the output logs in the log buffer.

\<Sysname\> display
logbuffer

Log buffer: Enabled

Max buffer size: 1024

Actual buffer size: 512

Dropped messages: 0

Overwritten messages: 0

Current messages: 5

%Jul 20 13:01:20:615 2022 Sysname
SHELL/6/SHELL\_CMD: -Line\=con0-IPAddr\=\*\*-User\=\*\*; Command is display logbuffer

%Jul 20 13:01:50:718 2022 Sysname
SHELL/6/SHELL\_CMD: -Line\=con0-IPAddr\=\*\*-User\=\*\*; Command is display logbuffer
This message repeated 2 times in last 30 seconds.

%Jul 20 13:03:50:732 2022 Sysname
SHELL/6/SHELL\_CMD: -Line\=con0-IPAddr\=\*\*-User\=\*\*; Command is display logbuffer
This message repeated 5 times in last 2 minutes.

%Jul 20 13:13:50:830 2022 Sysname
SHELL/6/SHELL\_CMD: -Line\=con0-IPAddr\=\*\*-User\=\*\*; Command is display logbuffer
This message repeated 10 times in last 10 minutes.

%Jul 20 13:23:50:211 2022 Sysname
SHELL/6/SHELL\_CMD: -Line\=con0-IPAddr\=\*\*-User\=\*\*; Command is display logbuffer
This message repeated 6 times in last 10 minutes.

%Jul 20 13:24:56:205 2022 Sysname
SHELL/6/SHELL\_CMD: -Line\=con0-IPAddr\=\*\*-User\=\*\*; Command is display logbuffer This message repeated 3 times in last 1 minute
6 seconds.

%Jul 20 13:25:41:205 2022
Sysname SHELL/6/SHELL\_CMD: -Line\=con0-IPAddr\=\*\*-User\=\*\*; Command is display interface brief.

\<Sysname\>

The output shows the following
information:

¡     The
information center stopped suppression for the log SHELL/6/SHELL\_CMD:
-Line\=con0-IPAddr\=\*\*-User\=\*\*; Command is display logbuffer.

¡     The
information center output the log SHELL/6/SHELL\_CMD:
-Line\=con0-IPAddr\=\*\*-User\=\*\*; Command is display interface brief, and
started suppression for it.

### Configuring log suppression for a module

#### About this task

This feature suppresses output of logs. You
can use this feature to filter out the logs that you are not concerned with.

Perform this task to configure a log
suppression rule to suppress output of all logs or logs with a specific mnemonic
value for a module.

#### Procedure

**1\.**Enter system view.

system-view

**2\.**Configure a log suppression rule for a
module.

info-center logging suppress module module-name mnemonic { all \| mnemonic-value }

By default, the device does not suppress
output of any logs from any modules.

### Disabling an interface from generating link up or link down logs

#### About this task

By default, an interface generates link up or
link down log information when the interface state changes. In some cases, you
might want to disable certain interfaces from generating this information. For
example:

·     You are concerned about the states of only some interfaces.
In this case, you can use this function to disable other interfaces from generating
link up and link down log information.

·     An interface is unstable and continuously
outputs log information. In this case, you can disable the interface from
generating link up and link down log information.

Use the default setting in normal cases to
avoid affecting interface status monitoring.

#### Procedure

**1\.**Enter system view.

system-view

**2\.**Enter interface view.

interface interface-type interface-number

**3\.**Disable the interface from generating link
up or link down logs.

undo enable log updown

By default, an interface generates link
up and link down logs when the interface state changes.

## Enabling SNMP notifications for system logs

#### About this task

This feature enables the device to send an
SNMP notification for each log message it outputs. The device encapsulates the
logs in SNMP notifications and then sends them to the SNMP module and the log trap
buffer.

You can configure the SNMP module to send
received SNMP notifications in SNMP traps or informs to remote hosts. For more information,
see "Configuring SNMP."

To view the traps in the log trap buffer,
access the MIB corresponding to the log trap buffer.

#### Procedure

**1\.**Enter system view.

system-view

**2\.**Enable SNMP notifications for system logs.

snmp-agent trap enable syslog

By default, the device does not send SNMP
notifications for system logs.

**3\.**Set the maximum number of traps that can be
stored in the log trap buffer.

info-center syslog trap buffersize buffersize

By default, the log trap buffer can store
a maximum of 1024 traps.

## Managing security logs

### Saving security logs to the security log file

#### About this task

Security logs are very important for
locating and troubleshooting network problems. Generally, security logs are
output together with other logs. It is difficult to identify security logs
among all logs.

To solve this problem, you can save
security logs to the security log file without affecting the current log output
rules.

After you enable the security log file
feature, the system processes security logs as follows:

**1\.**Outputs security logs to the security log
file buffer.

**2\.**Saves logs from the security log file buffer
to the security log file at the specified interval. 

If you have the security-audit role, you
can also manually save security logs to the security log file.

**3\.**Clears the security log file buffer
immediately after the security logs are saved to the security log file.

#### Restrictions and guidelines

The device supports only one security log
file. The system will overwrite old logs with new logs when the security log
file is full. To avoid security log loss, you can set an alarm threshold for
the security log file usage ratio. When the alarm threshold is reached, the
system outputs a message to inform you of the alarm. You can log in to the
device with the security-audit user role and back up the security log file to
prevent the loss of important data.

#### Procedure

**1\.**Enter system view.

system-view

**2\.**Enable the security log file feature.

info-center security-logfile enable

By default, the security log file feature
is disabled.

**3\.**Set the interval at which the system saves
security logs.

info-center security-logfile frequency freq-sec

The default security log file saving
interval is 86400 seconds. 

**4\.**(Optional.) Set the maximum size for the
security log file.

info-center security-logfile size-quota size

By default, the maximum security log file
size is 10 MB.

**5\.**(Optional.) Set the alarm threshold of the
security log file usage.

info-center security-logfile alarm-threshold usage

By default, the alarm threshold of the
security log file usage ratio is 80\. When the usage of the security log file
reaches 80%, the system will send a message.

### Managing the security log file

#### Restrictions and guidelines

To use the security log file management
commands, you must have the security-audit user role. For information about configuring
the security-audit user role, see AAA in Security Configuration
Guide.

#### Procedure

**1\.**Enter system view.

system-view

**2\.**Change the directory of the security log
file.

info-center security-logfile directory dir-name

By default, the security log file is
saved in the seclog directory in the root directory of the storage device.

The device uses the default security log
file directory after an IRF reboot or a master/subordinate switchover.

**3\.**Manually save all logs in the security log
file buffer to the security log file.

security-logfile save

This command is available in any view.

**4\.**(Optional.) Display the summary of the
security log file.

display security-logfile summary

This command is available in any view.

## Saving diagnostic logs to the diagnostic log file

#### About this task

By default, the diagnostic log file feature
saves diagnostic logs from the diagnostic log file buffer to the diagnostic log
file at the specified saving interval. You can also manually trigger an
immediate saving of diagnostic logs to the diagnostic log file. After saving diagnostic
logs to the diagnostic log file, the system clears the diagnostic log file
buffer.

The device supports only one diagnostic log
file. The diagnostic log file has a maximum capacity. When the capacity is
reached, the system replaces the oldest diagnostic logs with new logs.

#### Procedure

**1\.**Enter system view.

system-view

**2\.**Enable the diagnostic log file feature.

info-center diagnostic-logfile enable

By default, the diagnostic log file
feature is enabled.

**3\.**(Optional.) Set the maximum diagnostic log
file size.

info-center diagnostic-logfile quota size

By default, the maximum diagnostic log
file size is 10 MB.

**4\.**(Optional.) Specify the diagnostic log file directory.

info-center diagnostic-logfile directory dir-name

The default diagnostic log file directory
is flash:/diagfile.

The device uses the default diagnostic
log file directory after an IRF reboot or a master/subordinate switchover.

**5\.**Save diagnostic logs in the diagnostic log
file buffer to the diagnostic log file. Choose one option as needed:

¡     Configure the automatic diagnostic log file saving interval.

info-center diagnostic-logfile frequency freq-sec

The default saving interval is 86400
seconds. 

¡     Manually
save diagnostic logs to the diagnostic log file.

diagnostic-logfile save

This command is available in any view.

## Setting the maximum size of the trace log file

#### About this task

The device has only one trace log file. When
the trace log file is full, the device overwrites the oldest trace logs with
new ones.

#### Procedure

**1\.**Enter system view.

system-view

**2\.**Set the maximum size for the trace log file.

info-center trace-logfile quota size

The default maximum size of the trace log
file is 1 MB. 

## Display and maintenance commands for information center

Execute display commands
in any view and reset commands in user
view.

 

| Task | Command |
| --- | --- |
| Display the diagnostic log file configuration. | display diagnostic-logfile summary || Display the information center configuration. | display info-center || Display information about log output filters. | display info-center filter \[ filter-name ] || Display log buffer information and buffered logs. | display logbuffer  \[ reverse ] \[ level severity \| size buffersize \| slot slot-number ] \* \[ last-mins mins ] || Display the log buffer summary. | display logbuffer summary \[ level severity \| slot slot-number ] \* || Display the content of the log file buffer. | display logfile buffer || Display the log file configuration. | display logfile summary || Display the content of the security log file buffer. (To execute this command, you must have the security-audit user role.) | display security-logfile buffer || Display summary information of the security log file. | display security-logfile summary || Clear the log buffer. | reset logbuffer |










‌

## Information center configuration examples

### Example: Outputting logs to the console

#### Network configuration

Configure the device to output to the
console FTP logs that have a minimum severity level of warning.

Figure 2 Network diagram

![](https://resource.h3c.com/en/202407/12/20240712_11705831_x_Img_x_png_2_2216128_294551_0.png)

‌

#### Procedure

\# Enable the information center.

\<Device\> system-view

\[Device] info-center enable

\# Disable log output to the console.

\[Device] info-center source default
console deny

To avoid output of unnecessary information,
disable all modules from outputting log information to the specified destination
(console in this example) before you configure the
output rule.

\# Configure an output rule to output to the
console FTP logs that have a minimum severity level of warning.

\[Device] info-center source ftp
console level warning

\[Device] quit

\# Enable log output to the console.

\<Device\> terminal logging level
6

\<Device\> terminal monitor

The current terminal is enabled to
display logs.

Now, if the FTP module generates logs, the
information center automatically sends the logs to the console, and the console
displays the logs.

### Example: Outputting logs to a UNIX log host

#### Network configuration

Configure the device to output to the UNIX
log host FTP logs that have a minimum severity level of informational.

Figure 3 Network diagram

![](https://resource.h3c.com/en/202407/12/20240712_11705832_x_Img_x_png_3_2216128_294551_0.png)

‌

#### Procedure

**1\.**Make sure the device and the log host can
reach each other. (Details not shown.)

**2\.**Configure the device:

\# Enable the information center.

\<Device\> system-view

\[Device] info-center enable

\# Specify log host 1.2.0.1/16 with local4 as the
logging facility.

\[Device] info-center loghost 1.2.0.1
facility local4

\# Disable log output to the log host.

\[Device] info-center source
default loghost deny

To avoid output of unnecessary
information, disable all modules from outputting logs to the specified
destination (loghost in this example) before you configure an output rule.

\# Configure an output rule to output to
the log host FTP logs that have a minimum severity level of informational.

\[Device] info-center source ftp
loghost level informational

**3\.**Configure the log host:

The log host configuration procedure
varies by the vendor of the UNIX operating system. The following shows an
example:

**a.**Log in to the log host as a root user.

**b.**Create a subdirectory named Device in directory /var/log/,
and then create file info.log in the Device directory to save logs from the device.

\# mkdir /var/log/Device

\# touch /var/log/Device/info.log

**c.**Edit file syslog.conf
in directory /etc/ and add the following contents:

\# Device configuration
messages

local4.info
/var/log/Device/info.log

In this configuration, local4 is the
name of the logging facility that the log host uses to receive logs. The value info indicates
the informational severity level. The UNIX system records the log information that
has a minimum severity level of informational to file /var/log/Device/info.log.

 

|  | NOTE:  Follow these guidelines while editing file /etc/syslog.conf:  ·     Comments must be on a separate line and must begin with a pound sign (#).  ·     No redundant spaces are allowed after the file name.  ·     The logging facility name and the severity level specified in the /etc/syslog.conf file must be identical to those configured on the device by using the info\-center loghost and info-center source commands. Otherwise, the log information might not be output to the log host correctly. |
| --- | --- |

‌

**d.**Display the process ID of syslogd, kill the syslogd process,
and then restart syslogd by using the –r option to validate the configuration.

\# ps -ae \| grep syslogd

147

\# kill -HUP 147

\# syslogd -r \&

Now, the device can output FTP logs to the
log host, which stores the logs to the specified file.

### Example: Outputting logs to a Linux log host

#### Network configuration

Configure the device to output to the Linux
log host 1.2.0.1/16 FTP logs that have a minimum severity level of informational.

Figure 4 Network diagram

![](https://resource.h3c.com/en/202407/12/20240712_11705833_x_Img_x_png_4_2216128_294551_0.png)

‌

#### Procedure

**1\.**Make sure the device and the log host can
reach each other. (Details not shown.)

**2\.**Configure the device:

\# Enable the information center.

\<Device\> system-view

\[Device] info-center enable

\# Specify log host 1.2.0.1/16 with local5 as the
logging facility.

\[Device] info-center loghost
1.2.0.1 facility local5

\# Disable log output to the log host.

\[Device] info-center source
default loghost deny

To avoid outputting unnecessary
information, disable all modules from outputting log information to the
specified destination (loghost in this example) before you configure an output rule.

\# Configure an output rule to enable
output to the log host FTP logs that have a minimum severity level of informational.

\[Device] info-center source ftp
loghost level informational

**3\.**Configure the log host:

The log host configuration procedure
varies by the vendor of the Linux operating system. The following shows an
example:

**a.**Log in to the log host as a root user.

**b.**Create a subdirectory named Device in directory /var/log/,
and create file info.log in the Device directory to save logs from the device.

\# mkdir /var/log/Device

\# touch /var/log/Device/info.log

**c.**Edit file syslog.conf
in directory /etc/ and add the following contents:

\# Device configuration
messages

local5.info
/var/log/Device/info.log

In this configuration, local5 is the
name of the logging facility that the log host uses to receive logs. The value info indicates
the informational severity level. The Linux system will store the log information
with a severity level equal to or higher than informational to file /var/log/Device/info.log.

 

|  | NOTE:  Follow these guidelines while editing file /etc/syslog.conf:  ·     Comments must be on a separate line and must begin with a pound sign (#).  ·     No redundant spaces are allowed after the file name.  ·     The logging facility name and the severity level specified in the /etc/syslog.conf file must be identical to those configured on the device by using the info\-center loghost and info-center source commands. Otherwise, the log information might not be output to the log host correctly. |
| --- | --- |

‌

**d.**Display the process ID of syslogd, kill the syslogd
process, and then restart syslogd by using the -r option to validate the configuration.

Make sure the syslogd process
is started with the -r option on the Linux log host.

\# ps -ae \| grep syslogd

147

\# kill -9 147

\# syslogd -r \&

Now, the device can output FTP logs to the
log host, which stores the logs to the specified file.

 

